import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{C as v,L as c,I as m,S as b}from"./input.MG_-FBsV.js";import{B as g}from"./button.Dcm3U4MY.js";import{r as p}from"./index.DAubIFHI.js";import{c as f}from"./clientAPI.Cs9ptr1e.js";import{C}from"./checkbox.Cg_f7469.js";import{p as E}from"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";import"./index.Dym27YVG.js";function y(l){if(!l)return null;const r=E(l,"AR");return!r||!r.isValid()?null:r.format("E.164")}function P({zIndex:l}){const[r,d]=p.useState(!1),[u,x]=p.useState(null),[n,a]=p.useState({name:"",email:"",phone_number:"",speciality:"",state:!1});p.useEffect(()=>{const t=s=>{const i=s.detail;x(i),a({name:i.name??"",email:i.email?String(i.email):"",phone_number:i.phone_number??"",speciality:i.speciality??"",state:i.state==="activo"}),d(!0)};return window.addEventListener("open-edit-technician",t),()=>window.removeEventListener("open-edit-technician",t)},[]);const j=async t=>{t.preventDefault(),t.stopPropagation();let s;n.state?s="activo":s="inactivo";const i={name:n.name,email:n.email,phone_number:n.phone_number,speciality:n.speciality,state:s};try{let o;u?o=await f.technician({id:u.technician_id}).put(i):o=await f.technician.post(i);const{data:w,error:h}=o;if(h)throw h.value;window.location.reload()}catch(o){console.error("Error al cargar tecnico:",o),alert("Error al cargar tecnico")}};return e.jsx("form",{id:"form-sale",onSubmit:j,children:e.jsxs(v,{title:"Agregar Técnico",zIndex:l,isOpen:r,onOpenChange:d,description:"Agregar técnico al sistema",footer:e.jsxs(e.Fragment,{children:[e.jsx(g,{type:"submit",form:"form-sale",children:"Agregar"}),e.jsx(b,{asChild:!0,children:e.jsx(g,{variant:"outline",children:"Cancelar"})})]}),children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(c,{children:"Nombre"}),e.jsx(m,{value:n.name,onChange:t=>a({...n,name:t.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(c,{children:"Email"}),e.jsx(m,{type:"email",value:n.email,onChange:t=>a({...n,email:t.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(c,{children:"Telefono"}),e.jsx(m,{value:n.phone_number,onChange:t=>{a({...n,phone_number:t.target.value.replace(/[^\d+]/g,"")})},onBlur:()=>{const t=y(n.phone_number);t&&a({...n,phone_number:t})},inputMode:"tel",placeholder:"+54 9 11 1234 5678",required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(c,{children:"Especialidad"}),e.jsx(m,{value:n.speciality,onChange:t=>a({...n,speciality:t.target.value}),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx(c,{children:"Activo"}),e.jsx(C,{checked:n.state,onCheckedChange:t=>a({...n,state:!!t})})]})]})})}export{P as SheetFormTechnician};
