import{j as n}from"./jsx-runtime.D_zvdyIk.js";import{C as y,L as c,I as d,S as A}from"./input.MG_-FBsV.js";import{B as b}from"./button.Dcm3U4MY.js";import{r as m}from"./index.DAubIFHI.js";import{c as x}from"./clientAPI.Cs9ptr1e.js";import{p as I}from"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";function v(o){if(!o)return null;const r=I(o,"AR");return!r||!r.isValid()?null:r.format("E.164")}function G({isOpen:o,onClose:r,zIndex:_}){const[j,p]=m.useState(!1),C=o!==void 0?o:j,h=e=>{r?e||r():p(e)},[u,E]=m.useState(null),[t,a]=m.useState({name:"",email:"",phone_number:"",id_number:"",birth_date:""});m.useEffect(()=>{const e=l=>{const i=l.detail;E(i),a({name:i.name??"",email:i.email??"",phone_number:i.phone_number??"",id_number:i.id_number?String(i.id_number):"",birth_date:i.birth_date??""}),p(!0)};return window.addEventListener("open-edit-client",e),()=>window.removeEventListener("open-edit-client",e)},[]);const S=async e=>{e.preventDefault(),e.stopPropagation();const l=v(t.phone_number);if(!l){alert("El número de teléfono es inválido.");return}const i={...t,phone_number:l};try{let s;u?s=await x.client({id:u.client_id}).put(i):s=await x.client.post(i);const{data:N,error:g}=s;if(g)throw g.value;const f=N?.[0]?.client_id;r?.(f?String(f):void 0),window.location.reload()}catch(s){console.error(s),r?.()}},w=r!==void 0?"right-[380px]":"";return n.jsx("form",{id:"form-client",onSubmit:S,children:n.jsxs(y,{title:"Agregar Cliente",description:"Agregar ciente al sistema",className:`${w}`,side:"right",isOpen:C,onOpenChange:h,isModal:!r,zIndex:_||(r?50:10),footer:n.jsxs(n.Fragment,{children:[n.jsx(b,{type:"submit",form:"form-client",children:u?"Guardar":"Agregar"}),n.jsx(A,{asChild:!0,children:n.jsx(b,{variant:"outline",onClick:()=>h(!1),children:"Cancelar"})})]}),children:[n.jsxs("div",{className:"grid gap-3",children:[n.jsx(c,{children:"Nombre"}),n.jsx(d,{value:t.name,onChange:e=>a({...t,name:e.target.value}),required:!0})]}),n.jsxs("div",{className:"grid gap-3",children:[n.jsx(c,{children:"Email"}),n.jsx(d,{type:"email",value:t.email,onChange:e=>a({...t,email:e.target.value}),required:!0})]}),n.jsxs("div",{className:"grid gap-3",children:[n.jsx(c,{children:"Telefono"}),n.jsx(d,{value:t.phone_number,onChange:e=>a({...t,phone_number:e.target.value.replace(/[^\d+]/g,"")}),onBlur:()=>{const e=v(t.phone_number);e&&a({...t,phone_number:e})},inputMode:"tel",placeholder:"+54 9 11 1234 5678",required:!0})]}),n.jsx("div",{className:"grid gap-3",children:n.jsx(d,{type:"number",value:t.id_number,onChange:e=>a({...t,id_number:e.target.value})})})]})})}export{G as SheetFormClient};
