import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.DAubIFHI.js";import{c as g}from"./clientAPI.Cs9ptr1e.js";import{T as v}from"./TableWrapper.DH7mLV_p.js";import"./schema.Fil2OqHt.js";import"./formatters.P2c1JhjN.js";import"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";function f({data:a,columns:r}){const d=l.useCallback(i=>{const c=new CustomEvent("open-edit-provider",{detail:i});window.dispatchEvent(c)},[]),m=l.useCallback(async i=>{await g.provider({id:i.provider_id}).delete(),window.location.reload()},[]);return e.jsx(v,{data:a,columns:r,onEdit:d,onDelete:m})}function b(a){const r={};return a.name.trim()&&(r.name=a.name.trim()),a.email.trim()&&(r.email=a.email.trim()),a.phone_number.trim()&&(r.phone_number=a.phone_number.trim()),a.address.trim()&&(r.address=a.address.trim()),a.deleted==="active"&&(r.is_deleted="false"),a.deleted==="deleted"&&(r.is_deleted="true"),r}function k({initialData:a,columns:r}){const[d,m]=l.useState(a),[i,c]=l.useState(!1),[u,p]=l.useState(null),[s,o]=l.useState({name:"",email:"",phone_number:"",address:"",deleted:"active"}),x=l.useMemo(()=>b(s),[s]);l.useEffect(()=>{const n=setTimeout(async()=>{c(!0),p(null);try{const t=await g.provider.all.get({query:x});m(Array.isArray(t.data)?t.data:[])}catch(t){p(t?.message??"Error buscando proveedores")}finally{c(!1)}},350);return()=>clearTimeout(n)},[x]);function h(){o({name:"",email:"",phone_number:"",address:"",deleted:"active"})}return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx("div",{className:"rounded-2xl border bg-white p-4 shadow-lg",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Nombre",value:s.name,onChange:n=>o(t=>({...t,name:n.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Email",value:s.email,onChange:n=>o(t=>({...t,email:n.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Teléfono",value:s.phone_number,onChange:n=>o(t=>({...t,phone_number:n.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Dirección",value:s.address,onChange:n=>o(t=>({...t,address:n.target.value}))}),e.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:s.deleted,onChange:n=>o(t=>({...t,deleted:n.target.value})),children:[e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"deleted",children:"Eliminados"}),e.jsx("option",{value:"all",children:"Todos"})]})]}),e.jsx("div",{className:"my-4",children:e.jsx(f,{data:d,columns:r})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[i?"Buscando...":`${d.length} resultado(s)`,u?e.jsx("span",{className:"text-red-600",children:u}):null]}),e.jsx("button",{className:"rounded-lg border px-3 py-2 text-sm font-medium hover:bg-gray-50",onClick:h,type:"button",children:"Limpiar filtros"})]})]})})})})}export{k as ProviderPageManager};
