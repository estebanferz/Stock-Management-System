import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.DAubIFHI.js";import{c as g}from"./clientAPI.Cs9ptr1e.js";import{T as b}from"./TableWrapper.DH7mLV_p.js";import"./schema.Fil2OqHt.js";import"./formatters.P2c1JhjN.js";import"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";function f({data:t,columns:l}){const d=r.useCallback(s=>{const m=new CustomEvent("open-edit-client",{detail:s});window.dispatchEvent(m)},[]),u=r.useCallback(async s=>{await g.client({id:s.client_id}).delete(),window.location.reload()},[]);return e.jsx(b,{data:t,columns:l,onEdit:d,onDelete:u})}function v(t){const l={};return t.name.trim()&&(l.name=t.name.trim()),t.id_number.trim()&&(l.id_number=t.id_number.trim()),t.email.trim()&&(l.email=t.email.trim()),t.phone_number.trim()&&(l.phone_number=t.phone_number.trim()),t.deleted==="active"&&(l.is_deleted=!1),t.deleted==="deleted"&&(l.is_deleted=!0),l}function k({initialData:t,columns:l}){const[d,u]=r.useState(t),[s,m]=r.useState(!1),[c,p]=r.useState(null),[i,o]=r.useState({name:"",id_number:"",email:"",phone_number:"",deleted:"active"}),x=r.useMemo(()=>v(i),[i]);r.useEffect(()=>{const a=setTimeout(async()=>{m(!0),p(null);try{const n=await g.client.all.get({query:x});u(n.data||[])}catch(n){p(n?.message??"Error buscando clientes")}finally{m(!1)}},350);return()=>clearTimeout(a)},[x]);function h(){o({name:"",id_number:"",email:"",phone_number:"",deleted:"active"})}return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx("div",{className:"rounded-2xl border bg-white p-4 shadow-lg",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Nombre",value:i.name,onChange:a=>o(n=>({...n,name:a.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"DNI (completo)",inputMode:"numeric",value:i.id_number,onChange:a=>o(n=>({...n,id_number:a.target.value.replace(/\D/g,"")}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Email",value:i.email,onChange:a=>o(n=>({...n,email:a.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"TelÃ©fono",value:i.phone_number,onChange:a=>o(n=>({...n,phone_number:a.target.value}))}),e.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:i.deleted,onChange:a=>o(n=>({...n,deleted:a.target.value})),children:[e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"deleted",children:"Eliminados"}),e.jsx("option",{value:"all",children:"Todos"})]})]}),e.jsx("div",{className:"my-4",children:e.jsx(f,{data:d,columns:l})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[s?"Buscando...":`${d.length} resultado(s)`,c?e.jsx("span",{className:"text-red-600",children:c}):null]}),e.jsx("button",{className:"rounded-lg border px-3 py-2 text-sm font-medium hover:bg-gray-50",onClick:h,type:"button",children:"Limpiar filtros"})]})]})})})})}export{k as ClientsPageManager};
