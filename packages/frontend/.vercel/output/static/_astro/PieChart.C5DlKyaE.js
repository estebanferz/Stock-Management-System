import{j as G}from"./jsx-runtime.D_zvdyIk.js";import{R as T,r as d}from"./index.DAubIFHI.js";function k(t){const[r,e]=d.useState(!0),[a,o]=d.useState(null),[n,s]=d.useState(!1),c=()=>{e(!1),s(!0)};return d.useEffect(()=>{if(!document){const g=new Error(`[ScriptLoadingError] document not defined when attempting to load ${t}`);o(g);return}const l=document.querySelector(`script[src="${t}"]`);if(l?.dataset.loaded){c();return}const i=l||document.createElement("script");l||(i.src=t);const m=()=>{i.dataset.loaded="1",c()};i.addEventListener("load",m),i.addEventListener("error",g=>{console.error("Failed to load script:",t,g);const h=new Error(`[ScriptLoadingError] Failed to load script: ${t}`);o(h)}),l||document.head.append(i)},[]),{isLoading:r,error:a,isSuccess:n}}const U=t=>t&&t.charts,W=(t,r)=>{const{controls:e,toolbarItems:a,getChartEditor:o}=t;return r&&r.charts&&r.visualization&&r.visualization.ChartWrapper&&r.visualization.Dashboard&&(!e||r.visualization.ChartWrapper)&&(!o||r.visualization.ChartEditor)&&(!a||r.visualization.drawToolbar)},B=t=>window.google;function H(t){const{chartVersion:r="current",chartPackages:e=["corechart","controls"],chartLanguage:a="en",mapsApiKey:o}=t,[n,s]=d.useState(null),[c,l]=d.useState(null),[i,m]=d.useState(null),{isLoading:g,error:h,isSuccess:u}=k(t.chartLoaderScriptUrl||"https://www.gstatic.com/charts/loader.js");return d.useEffect(()=>{if(!u)return;const v=B();if(!U(v)){const w=new Error("[ScriptInitializationError] Script loaded but Google not attached to window.");l(w);return}if(W(t,v)){s(v);return}v.charts.load(r,{packages:e,language:a,mapsApiKey:o}),v.charts.setOnLoadCallback(()=>{if(!W(t,v)){const w=new Error("[GoogleChartsInitializationError] Google Charts not ready after load callback.");console.error(w),m(w);return}s(v)})},[u]),{error:h||c||i,isLoading:g,google:n}}const O={legend_toggle:!1,options:{},legendToggle:!1,getChartWrapper:()=>{},spreadSheetQueryParameters:{headers:1,gid:1},rootProps:{},chartWrapperParams:{},chartLoaderScriptUrl:"https://www.gstatic.com/charts/loader.js"},N=t=>{const{isReady:r,chartControls:e,filter:a}=t;return!r||!e||!e?.length?null:T.createElement(T.Fragment,null,e.filter(o=>{let{controlProp:n,control:s}=o;return a?a({control:s,controlProp:n}):!0}).map(o=>{let{control:n}=o;return T.createElement("div",{key:n.getContainerId(),id:n.getContainerId()})}))};let $=0;const R=()=>($+=1,`reactgooglegraph-${$}`);class q{static initializeControls=r=>{for(let e=0;e<r.length;e+=1){const{controlType:a,options:o,controlWrapperParams:n}=r[e].controlProp;n&&"state"in n&&r[e].control.setState(n.state),r[e].control.setOptions(o),r[e].control.setControlType(a)}};static listenToControlEvents=(r,e)=>{const{google:a}=e;return r.flatMap(o=>{const{control:n,controlProp:s}=o,{controlEvents:c=[]}=s;return c.map(l=>{const{callback:i,eventName:m}=l;return a.visualization.events.addListener(n,m,function(){for(var g=arguments.length,h=new Array(g),u=0;u<g;u++)h[u]=arguments[u];i({chartWrapper:null,controlWrapper:n,props:e,google:a,eventArgs:h})})})})};static createControlId=r=>{let e;return typeof r>"u"?e=`googlechart-control-${R()}`:e=r,e};static createChartControls=r=>{const{controls:e,google:a}=r;return e?e.map((o,n)=>{const{controlID:s,controlType:c,options:l,controlWrapperParams:i}=o,m=this.createControlId(s);return{controlProp:o,control:new a.visualization.ControlWrapper({containerId:m,controlType:c,options:l,...i})}}):null};static addControls=r=>{const{chartWrapper:e,chartDashboard:a}=r,o=this.createChartControls(r);return!o||!a||!e?null:(a.bind(o.map(n=>{let{control:s}=n;return s}),e),this.initializeControls(o),o)}}const _=t=>{const[r,e]=d.useState(null);return[d.useMemo(()=>!r||!t?null:t.map((o,n)=>{const s=r[n];return s?{controlProp:o,control:s}:void 0}).flatMap(o=>o?[o]:[]),[r,t]),e]},M=(t,r)=>{d.useEffect(()=>{const e=q.listenToControlEvents(t??[],r);return()=>{e.forEach(a=>{r.google.visualization.events.removeListener(a)})}},[t,r])},j=t=>{const[r,e]=_(t.controls);return M(r??[],t),{addControls:o=>{const n=q.addControls(o);e(n?.map(s=>s.control)??null)},renderControl:o=>{const{chartWrapper:n,chartDashboard:s}=t;return d.createElement(N,{...t,isReady:!!(n&&s),chartControls:r,filter:o})}}},Q=t=>{const r=d.useRef(null);return{chartId:(()=>{const{graphID:o,graph_id:n}=t,s=o||n;let c;return s?c=s:c=r.current||R(),r.current=c,r.current})()}},V=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC"],K=async function(t,r){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return new Promise((a,o)=>{const n=`${e.headers?`headers=${e.headers}`:"headers=0"}`,s=`${e.query?`&tq=${encodeURIComponent(e.query)}`:""}`,c=`${e.gid?`&gid=${e.gid}`:""}`,l=`${e.sheet?`&sheet=${e.sheet}`:""}`,i=`${e.access_token?`&access_token=${e.access_token}`:""}`,m=`${n}${c}${l}${s}${i}`,g=`${r}/gviz/tq?${m}`;new t.visualization.Query(g).send(u=>{u.isError()?o(`Error in query:  ${u.getMessage()} ${u.getDetailedMessage()}`):a(u.getDataTable())})})},Y="#CCCCCC";class A{static grayOutHiddenColumnsLabel=(r,e)=>{const{googleChartWrapper:a,options:o}=r;if(!a){console.error("googleChartWrapper is not defined");return}const n=a.getDataTable();if(!n)return;const s=n.getNumberOfColumns();if(e.length>0===!1)return;const l=Array.from({length:s-1}).map((i,m)=>{const g=this.getColumnId(n,m+1);return e.includes(g)?Y:o&&o.colors?o.colors[m]:V[m]});a.setOptions({...o,colors:l}),a.draw()};static listenToLegendToggle=(r,e)=>{const[a,o]=e,{google:n,googleChartWrapper:s}=r;if(!s){console.error("googleChartWrapper is not defined");return}return n.visualization.events.addListener(s,"select",()=>{const l=s.getChart().getSelection(),i=s.getDataTable();if(l.length===0||l[0].row!==null||!i)return;const m=l[0].column,g=this.getColumnId(i,m);a?.includes(g)?o(h=>[...h.filter(u=>u!==g)]):o(h=>[...h,g])})};static draw=async r=>{const{data:e,diffdata:a,rows:o,columns:n,options:s,chartType:c,formatters:l,spreadSheetUrl:i,spreadSheetQueryParameters:m,googleChartDashboard:g,googleChartWrapper:h,google:u,hiddenColumns:v,legendToggle:w,legend_toggle:D}=r;if(!h){console.error("draw was called with googleChartWrapper = null");return}let f,C=null;if(a){const S=u.visualization.arrayToDataTable(a.old),p=u.visualization.arrayToDataTable(a.new);C=u.visualization[c].prototype.computeDiff(S,p)}e?e instanceof u.visualization.DataTable?f=e:Array.isArray(e)?f=u.visualization.arrayToDataTable(e):f=new u.visualization.DataTable(e):o&&n?f=u.visualization.arrayToDataTable([n,...o]):i?f=await K(u,i,m):f=u.visualization.arrayToDataTable([]);const E=f.getNumberOfColumns(),I=Array(E).fill(0).map((S,p)=>{const L=this.getColumnId(f,p);return v.includes(L)?{label:f.getColumnLabel(p),type:f.getColumnType(p),calc:()=>null}:p}),z=h.getChart();h.getChartType()==="Timeline"&&z&&z.clearChart(),h.setChartType(c),h.setOptions(s||{});const y=new u.visualization.DataView(f);y.setColumns(I),h.setDataTable(y),h.draw(),g&&g.draw(f),C&&(h.setDataTable(C),h.draw()),l&&(this.applyFormatters({dataTable:f,formatters:l,google:u}),h.setDataTable(f),h.draw()),(w===!0||D===!0)&&this.grayOutHiddenColumnsLabel(r,v)};static getColumnId=(r,e)=>r.getColumnId(e)||r.getColumnLabel(e);static applyFormatters=r=>{let{dataTable:e,formatters:a,google:o}=r;for(let n of a)switch(n.type){case"ArrowFormat":{new o.visualization.ArrowFormat(n.options).format(e,n.column);return}case"BarFormat":{new o.visualization.BarFormat(n.options).format(e,n.column);return}case"ColorFormat":{const s=new o.visualization.ColorFormat(n.options),{ranges:c}=n;if(c)for(let l of c)s.addRange(...l);s.format(e,n.column);return}case"DateFormat":{new o.visualization.DateFormat(n.options).format(e,n.column);return}case"NumberFormat":{new o.visualization.NumberFormat(n.options).format(e,n.column);return}case"PatternFormat":{new o.visualization.PatternFormat(n.options).format(e,n.column);return}default:{console.warn(`Unknown formatter type: ${n.type}`);return}}}}const J=t=>{const{google:r,googleChartWrapper:e,googleChartDashboard:a}=t,[o,n]=d.useState([]);d.useEffect(()=>{e&&A.draw({...t,hiddenColumns:o,googleChartWrapper:e,googleChartDashboard:a,google:r})},[o,t.data,t.rows,t.columns,t.options,t.chartLoaderScriptUrl,t.chartType,t.formatters,t.spreadSheetUrl,t.spreadSheetQueryParameters,t.legendToggle,t.legend_toggle]);const s=()=>{const{googleChartWrapper:i}=t;i&&i.draw()},c=i=>{const m=[],{legendToggle:g,legend_toggle:h}=t;if(A.draw({...t,hiddenColumns:o,googleChartWrapper:i,googleChartDashboard:a,google:r}),window.addEventListener("resize",s),h||g){const u=A.listenToLegendToggle(t,[o,n]);u&&m.push(u)}return m},l=(i,m)=>{window.removeEventListener("resize",s),m.forEach(g=>{r.visualization.events.removeListener(g)}),i.getChartType()==="Timeline"&&i.getChart()&&i.getChart().clearChart()};d.useEffect(()=>{if(!e)return;const i=c(e);return()=>{l(e,i)}},[e,c,l])},X=t=>{const{chartEvents:r,google:e,googleChartWrapper:a}=t;if(r){if(!a){console.warn("listenToEvents was called before chart wrapper ready.");return}return r.map(o=>{let{eventName:n,callback:s}=o;return e.visualization.events.addListener(a,n,function(){for(var c=arguments.length,l=new Array(c),i=0;i<c;i++)l[i]=arguments[i];s({chartWrapper:a,props:t,google:e,eventArgs:l})})})}},Z=t=>{d.useEffect(()=>{if(!t.googleChartWrapper)return;const r=X(t);return()=>{r?.forEach(e=>{t.google.visualization.events.removeListener(e)})}},[t])},tt=t=>{const[r,e]=d.useState(null),[a,o]=d.useState(null),{addControls:n,renderControl:s}=j({...t,chartDashboard:a,chartWrapper:r});Z({...t,googleChartWrapper:r});const{chartId:c}=Q(t),l=d.useRef(null),i=d.useRef(null);d.useEffect(()=>{const{options:f,google:C,chartType:E,chartWrapperParams:I,toolbarItems:z,getChartEditor:y,getChartWrapper:S,onLoad:p}=t,L={chartType:E,options:f,containerId:c,...I},b=new C.visualization.ChartWrapper(L);b.setOptions(f||{}),S?.(b,C);const F=new C.visualization.Dashboard(l.current);z&&C.visualization.drawToolbar(i.current,z);let P=null;y&&(P=new C.visualization.ChartEditor,y({chartEditor:P,chartWrapper:b,google:C})),n({...t,chartDashboard:F,chartWrapper:b}),e(b),o(F),p?.(C,{google:C,chartWrapper:b,chartEditor:P,chartDashboard:F})},[]),J({...t,googleChartWrapper:r,googleChartDashboard:a});const m=()=>{const{width:f,height:C,options:E,style:I,className:z,rootProps:y,google:S}=t,p={height:C||E&&E.height,width:f||E&&E.width,...I};return d.createElement("div",{id:c,style:p,className:z,...y})},g=()=>t.toolbarItems?d.createElement("div",{ref:i}):null,{width:h,height:u,options:v,style:w}=t,D={height:u||v&&v.height,width:h||v&&v.width,...w};return t.render?d.createElement("div",{ref:l,style:D},d.createElement("div",{ref:i,id:"toolbar"}),t.render({renderChart:m,renderControl:s,renderToolbar:g})):d.createElement("div",{ref:l,style:D},s(f=>{let{controlProp:C}=f;return C.controlPosition!=="bottom"}),m(),s(f=>{let{controlProp:C}=f;return C.controlPosition==="bottom"}),g())},et=d.createContext(O),rt=t=>{let{children:r,value:e}=t;return d.createElement(et.Provider,{value:e},r)},ot=t=>{const{google:r,isLoading:e,error:a}=H(t);return e?t.loader??null:a?t.errorElement??null:r?T.createElement(tt,{google:r,...t}):null},nt=t=>{const r={...O,...t};return T.createElement(rt,{value:r},T.createElement(ot,r))};var x;(function(t){t.annotation="annotation",t.annotationText="annotationText",t.certainty="certainty",t.emphasis="emphasis",t.interval="interval",t.scope="scope",t.style="style",t.tooltip="tooltip",t.domain="domain"})(x||(x={}));const at=["#004aad","#275fa8","#3b69a6","#4e72a2","#627c9f"],st={backgroundColor:"transparent",title:"Productos m√°s vendidos",pieHole:.25,is3D:!1,colors:at,titleTextStyle:{fontSize:20,bold:!0,color:"#374151",textAlign:"center"},legend:{position:"right",alignment:"center",textStyle:{color:"black",fontSize:10}}};function ct({data:t,className:r}){return G.jsx(nt,{className:r,chartType:"PieChart",width:"100%",height:"300px",data:t,options:st})}export{ct as PieChart};
