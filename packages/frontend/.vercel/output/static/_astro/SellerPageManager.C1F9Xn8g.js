import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.DAubIFHI.js";import{c as g}from"./clientAPI.Cs9ptr1e.js";import{T as v}from"./TableWrapper.DH7mLV_p.js";import"./schema.Fil2OqHt.js";import"./formatters.P2c1JhjN.js";import"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";function _({data:a,columns:o}){const d=i.useCallback(r=>{const m=new CustomEvent("open-edit-seller",{detail:r});window.dispatchEvent(m)},[]),c=i.useCallback(async r=>{await g.seller({id:r.seller_id}).delete(),window.location.reload()},[]);return e.jsx(v,{data:a,columns:o,onEdit:d,onDelete:c})}function y(a){const o={};return a.name.trim()&&(o.name=a.name.trim()),a.hire_date&&(o.hire_date=a.hire_date),a.pay_date&&(o.pay_date=a.pay_date),a.age_min&&(o.age_min=a.age_min),a.age_max&&(o.age_max=a.age_max),a.commission_min&&(o.commission_min=a.commission_min),a.commission_max&&(o.commission_max=a.commission_max),a.deleted==="active"&&(o.is_deleted="false"),a.deleted==="deleted"&&(o.is_deleted="true"),o}function F({initialData:a,columns:o}){const[d,c]=i.useState(a),[r,m]=i.useState(!1),[u,p]=i.useState(null),[s,l]=i.useState({name:"",hire_date:"",pay_date:"",age_min:"",age_max:"",commission_min:"",commission_max:"",deleted:"active"}),x=i.useMemo(()=>y(s),[s]);i.useEffect(()=>{const t=setTimeout(async()=>{m(!0),p(null);try{const n=await g.seller.all.get({query:x});c(Array.isArray(n.data)?n.data:[])}catch(n){p(n?.message??"Error buscando vendedores")}finally{m(!1)}},350);return()=>clearTimeout(t)},[x]);function h(){l({name:"",hire_date:"",pay_date:"",age_min:"",age_max:"",commission_min:"",commission_max:"",deleted:"active"})}return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx("div",{className:"rounded-2xl border bg-white p-4 shadow-lg",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Nombre",value:s.name,onChange:t=>l(n=>({...n,name:t.target.value}))}),e.jsxs("div",{className:"relative group w-full",children:[e.jsx("input",{type:"date",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:s.hire_date,onChange:t=>l(n=>({...n,hire_date:t.target.value}))}),e.jsx("span",{className:`absolute -top-9 left-0 z-50 whitespace-nowrap rounded-md border bg-white px-3 py-1 text-xs font-medium text-black shadow-lg
                            opacity-0 scale-95 transition-all duration-200
                            group-hover:opacity-100 group-hover:scale-100
                            pointer-events-none`,children:"Fecha de contratación"})]}),e.jsxs("div",{className:"relative group w-full",children:[e.jsx("input",{type:"date",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:s.pay_date,onChange:t=>l(n=>({...n,pay_date:t.target.value}))}),e.jsx("span",{className:`absolute -top-9 left-0 z-50 whitespace-nowrap rounded-md border bg-white px-3 py-1 text-xs font-medium text-black shadow-lg
                            opacity-0 scale-95 transition-all duration-200
                            group-hover:opacity-100 group-hover:scale-100
                            pointer-events-none`,children:"Fecha de cobro"})]}),e.jsx("input",{type:"number",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Edad mín.",value:s.age_min,onChange:t=>l(n=>({...n,age_min:t.target.value}))}),e.jsx("input",{type:"number",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Edad máx.",value:s.age_max,onChange:t=>l(n=>({...n,age_max:t.target.value}))}),e.jsx("input",{type:"number",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Comisión mín. (%)",value:s.commission_min,onChange:t=>l(n=>({...n,commission_min:t.target.value}))}),e.jsx("input",{type:"number",className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Comisión máx. (%)",value:s.commission_max,onChange:t=>l(n=>({...n,commission_max:t.target.value}))}),e.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:s.deleted,onChange:t=>l(n=>({...n,deleted:t.target.value})),children:[e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"deleted",children:"Eliminados"}),e.jsx("option",{value:"all",children:"Todos"})]}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"})]}),e.jsx("div",{className:"my-4",children:e.jsx(_,{data:d,columns:o})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[r?"Buscando...":`${d.length} resultado(s)`,u?e.jsx("span",{className:"text-red-600",children:u}):null]}),e.jsx("button",{className:"rounded-lg border px-3 py-2 text-sm font-medium hover:bg-gray-50",onClick:h,type:"button",children:"Limpiar filtros"})]})]})})})})}export{F as SellerPageManager};
