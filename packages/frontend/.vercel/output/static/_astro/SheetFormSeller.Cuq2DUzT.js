import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{C,L as o,I as s,S as E}from"./input.MG_-FBsV.js";import{B as j}from"./button.Dcm3U4MY.js";import{r as m}from"./index.DAubIFHI.js";import{c as f}from"./clientAPI.Cs9ptr1e.js";import{t as S}from"./formatters.P2c1JhjN.js";import{p as w}from"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";const T=()=>{const n=new Date;return new Date(n.getTime()-n.getTimezoneOffset()*6e4)};function D(n){if(!n)return null;const l=w(n,"AR");return!l||!l.isValid()?null:l.format("E.164")}function H({zIndex:n}){const l=T(),[c,p]=m.useState(l.toISOString().split("T")[0]),[u,g]=m.useState(l.toISOString().split("T")[0]),[_,h]=m.useState(!1),[x,b]=m.useState(null),[a,i]=m.useState({name:"",age:"",email:"",phone_number:"",hire_date:"",pay_date:"",commission:""});m.useEffect(()=>{const r=d=>{const t=d.detail;b(t),p(S(t.hire_date)),g(S(t.pay_date)),i({name:t.name??"",age:t.age?String(t.age):"",email:t.email?String(t.email):"",phone_number:t.phone_number??"",hire_date:t.hire_date??"",pay_date:t.pay_date??"",commission:t.commission?String(t.commission):""}),h(!0)};return window.addEventListener("open-edit-seller",r),()=>window.removeEventListener("open-edit-seller",r)},[]);const y=async r=>{r.preventDefault(),r.stopPropagation(),console.log(c.toString().split("T")[0]);const d={name:a.name,age:parseInt(a.age),email:a.email,phone_number:a.phone_number,hire_date:c.toString().split("T")[0],pay_date:u.toString().split("T")[0],commission:a.commission};try{let t;x?t=await f.seller({id:x.seller_id}).put(d):t=await f.seller.post(d);const{data:N,error:v}=t;if(v)throw v.value;window.location.reload()}catch(t){console.error("Error al cargar vendedor:",t),alert("Error al cargar vendedor")}};return e.jsx("form",{id:"form-sale",onSubmit:y,children:e.jsxs(C,{title:"Agregar Vendedor",zIndex:n,isOpen:_,onOpenChange:h,description:"Agregar vendedor al sistema",footer:e.jsxs(e.Fragment,{children:[e.jsx(j,{type:"submit",form:"form-sale",children:"Agregar"}),e.jsx(E,{asChild:!0,children:e.jsx(j,{variant:"outline",children:"Cancelar"})})]}),children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Nombre"}),e.jsx(s,{value:a.name,onChange:r=>i({...a,name:r.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Edad"}),e.jsx(s,{type:"number",value:a.age,onChange:r=>i({...a,age:r.target.value})})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Email"}),e.jsx(s,{type:"email",value:a.email,onChange:r=>i({...a,email:r.target.value}),required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Telefono"}),e.jsx(s,{value:a.phone_number,onChange:r=>{i({...a,phone_number:r.target.value.replace(/[^\d+]/g,"")})},onBlur:()=>{const r=D(a.phone_number);r&&i({...a,phone_number:r})},inputMode:"tel",placeholder:"+54 9 223 1234567",required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Comisión"}),e.jsx(s,{value:a.commission,onChange:r=>i({...a,commission:r.target.value}),type:"number",placeholder:"0.00",required:!0})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Fecha de contratación"}),e.jsx(s,{type:"date",value:c,onChange:r=>p(r.target.value)})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(o,{children:"Fecha de pago"}),e.jsx(s,{type:"date",value:u,onChange:r=>g(r.target.value)})]})]})})}export{H as SheetFormSeller};
