import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.DAubIFHI.js";import{c as h}from"./clientAPI.Cs9ptr1e.js";import{T as v}from"./TableWrapper.DH7mLV_p.js";import"./schema.Fil2OqHt.js";import"./formatters.P2c1JhjN.js";import"./parsePhoneNumber.CAsXhxWl.js";import"./x.BNoxzAwW.js";import"./index.C7LY66bV.js";import"./index.64NwWGNV.js";import"./utils.CDN07tui.js";function b({data:t,columns:n}){const c=s.useCallback(r=>{const d=new CustomEvent("open-edit-technician",{detail:r});window.dispatchEvent(d)},[]),u=s.useCallback(async r=>{await h.technician({id:r.technician_id}).delete(),window.location.reload()},[]);return e.jsx(v,{data:t,columns:n,onEdit:c,onDelete:u})}const f=[{value:"activo",label:"Activo"},{value:"inactivo",label:"Inactivo"}];function j(t){const n={};return t.name.trim()&&(n.name=t.name.trim()),t.speciality.trim()&&(n.speciality=t.speciality.trim()),t.state.trim()&&(n.state=t.state.trim()),t.email.trim()&&(n.email=t.email.trim()),t.phone_number.trim()&&(n.phone_number=t.phone_number.trim()),t.deleted==="active"&&(n.is_deleted="false"),t.deleted==="deleted"&&(n.is_deleted="true"),n}function M({initialData:t,columns:n}){const[c,u]=s.useState(t),[r,d]=s.useState(!1),[m,p]=s.useState(null),[i,o]=s.useState({name:"",speciality:"",state:"",email:"",phone_number:"",deleted:"active"}),x=s.useMemo(()=>j(i),[i]);s.useEffect(()=>{const a=setTimeout(async()=>{d(!0),p(null);try{const l=await h.technician.all.get({query:x});u(Array.isArray(l.data)?l.data:[])}catch(l){p(l?.message??"Error buscando técnicos")}finally{d(!1)}},350);return()=>clearTimeout(a)},[x]);function g(){o({name:"",speciality:"",state:"",email:"",phone_number:"",deleted:"active"})}return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"mx-auto max-w-6xl",children:e.jsx("div",{className:"rounded-2xl border bg-white p-4 shadow-lg",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-5",children:[e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Nombre",value:i.name,onChange:a=>o(l=>({...l,name:a.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Especialidad",value:i.speciality,onChange:a=>o(l=>({...l,speciality:a.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Email",value:i.email,onChange:a=>o(l=>({...l,email:a.target.value}))}),e.jsx("input",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",placeholder:"Teléfono",value:i.phone_number,onChange:a=>o(l=>({...l,phone_number:a.target.value}))}),e.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:i.state,onChange:a=>o(l=>({...l,state:a.target.value})),children:[e.jsx("option",{value:"",children:"Estado"}),f.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]}),e.jsxs("select",{className:"w-full rounded-lg border px-3 py-2 text-sm outline-none focus:ring-2",value:i.deleted,onChange:a=>o(l=>({...l,deleted:a.target.value})),children:[e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"deleted",children:"Eliminados"}),e.jsx("option",{value:"all",children:"Todos"})]}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"}),e.jsx("div",{className:"hidden lg:block"})]}),e.jsx("div",{className:"my-4",children:e.jsx(b,{data:c,columns:n})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[r?"Buscando...":`${c.length} resultado(s)`,m?e.jsx("span",{className:"text-red-600",children:m}):null]}),e.jsx("button",{className:"rounded-lg border px-3 py-2 text-sm font-medium hover:bg-gray-50",onClick:g,type:"button",children:"Limpiar filtros"})]})]})})})})}export{M as TechnicianPageManager};
