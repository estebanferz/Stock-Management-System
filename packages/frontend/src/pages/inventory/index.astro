---

import Layout from "../../layouts/Layout.astro";
import { SheetFormPhone } from "@/components/SheetForms/SheetFormPhone";
import { serverApp } from "@/lib/serverAPI";
import { phoneColumns } from "@/config/PhoneColumnConfig";
import ActionPanel from "@/components/ActionPanel";
import { PhonesPageManager } from "@/components/PageManager/PhonePageManager";
import { requireAuth } from "@/lib/requireAuth";
const session = await requireAuth(Astro);
if (!session) return Astro.redirect("/login");
const { auth, cookieHeader } = session;
const authed = { headers: { cookie: cookieHeader } };

const response = await serverApp.phone.all.get({ query: { is_deleted: false } });
const data: any[] = Array.isArray(response.data) ? response.data : [];
    

---

<Layout title="Inventario" user={auth.user}>
    <h1 class="w-full text-center text-4xl text-gray-700 font-bold my-5">Inventario</h1>
    

    <PhonesPageManager
        client:load
        initialData={data}
        columns={phoneColumns}
    />

    <div class="justify-center mt-24 lg:mt-20 hidden md:block" slot="tercer-columna">
        <ActionPanel client:load />
    </div>

    <div
        class="group fixed right-10 lg:right-1/4 bottom-10 z-30"
    >
        <span 
        class="absolute bottom-full right-0 mb-2 whitespace-nowrap rounded-md border bg-white px-4 py-2 
                text-sm font-medium text-black shadow-lg
                opacity-0 scale-95 transition-all duration-200 
                group-hover:opacity-100 group-hover:scale-100
                pointer-events-none"
        >
        Nuevo Dispositivo
        </span>

        <SheetFormPhone zIndex={60} client:load/>
    </div>
</Layout>