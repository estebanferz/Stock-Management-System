# Usa la imagen base completa de Bun
FROM oven/bun:1

# Establece el directorio de trabajo
WORKDIR /app

# Copia solo los archivos de dependencias de todo el monorepo
COPY package.json .
COPY bun.lock .
COPY packages/frontend/package.json ./packages/frontend/
# (Añade más si tienes otros paquetes)

# Instala TODAS las dependencias (incluyendo devDependencies como 'astro')
# NODE_ENV=development está seteado en tu docker-compose, así que instalará todo.
RUN bun install

# Expone el puerto de Astro
EXPOSE 4321

# Un comando por defecto (aunque tu docker-compose lo va a sobrescribir)
CMD ["bun", "run", "dev"]
